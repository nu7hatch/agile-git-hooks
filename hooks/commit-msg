#!/bin/sh

cat $1 | grep '^\[#[0-9]\+\] .\+'

if [ "$?" != "0" ]; then
    echo "ERROR: There's no story assigned to your current work!"
    echo 
    echo "Save a story ID in the '.pivotal' dotfile in project root directory"
    echo "or specify it in \$STORY environment variable."
    echo
    echo "If you know what you're doing, but you know, for real... Then you can"
    echo "force this operation now."
    echo

    exec < /dev/tty
    read -p "Do you want to commit anyway? (y/N) " answer

    if [ "$answer" != "y" ] && [ "$answer" != "Y" ]; then
        echo
        echo "Aborting..."
        exit 1
    fi
fi
